<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Skino Custom Dome Preview</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background: #ffffff;
    }

    #dome-wrapper {
        display: flex;
        gap: 20px;
        align-items: flex-start;
        max-width: 1000px;
        margin: 0 auto;
    }

    #dome-canvas {
        width: 380px;
        height: 380px;
        border-radius: 50%;
        display: block;
        margin-bottom: 10px;
        cursor: grab;
        background: #ffffff; /* чист бял фон под купола */
        box-shadow: 0 0 20px rgba(0,0,0,0.35);
    }

    #dome-controls {
        flex: 1;
        max-width: 420px;
        padding: 15px;
        border-radius: 12px;
        background: #f8f9fb;
        box-shadow: 0 0 10px rgba(0,0,0,0.08);
    }

    .dome-label {
        margin: 8px 0 4px;
        font-weight: bold;
        font-size: 14px;
        color: #333;
    }

    .dome-input,
    #font-select,
    #text-color,
    #preview-text {
        width: 100%;
        padding: 8px;
        margin-bottom: 8px;
        border-radius: 6px;
        border: 1px solid #bbb;
        font-size: 14px;
        box-sizing: border-box;
    }

    #bg-colors button {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        border: 1px solid #666;
        margin-right: 6px;
        cursor: pointer;
    }

    .dome-btn {
        background: #0077ff;
        color: #fff;
        border: none;
        padding: 10px 16px;
        cursor: pointer;
        border-radius: 8px;
        font-weight: bold;
        margin-top: 10px;
        margin-right: 8px;
        font-size: 14px;
    }

    .dome-btn.red {
        background: #d93636;
    }

    p.dome-help {
        font-size: 12px;
        color: #666;
        margin-top: 10px;
        line-height: 1.4;
    }

    @media (max-width: 768px) {
        #dome-wrapper {
            flex-direction: column;
            align-items: center;
        }
        #dome-controls {
            width: 100%;
            max-width: 95%;
        }
        #dome-canvas {
            width: 90vw;
            height: 90vw;
        }
    }
</style>
</head>
<body>

<div id="dome-wrapper">
    <canvas id="dome-canvas" width="800" height="800"></canvas>

    <div id="dome-controls">
        <div class="dome-label">Type your text</div>
        <input id="preview-text" placeholder="Type your text..." class="dome-input">

        <div class="dome-label">Upload your logo (preview only)</div>
        <input type="file" id="logo-upload" accept="image/*" class="dome-input">

        <div class="dome-label">Background</div>
        <div id="bg-colors">
            <button data-bg="white" style="background:#fff"></button>
            <button data-bg="black" style="background:#000"></button>
            <button data-bg="silver" style="background:linear-gradient(145deg,#ddd,#999)"></button>
            <button data-bg="red" style="background:#b00000"></button>
            <button data-bg="blue" style="background:#003dff"></button>
        </div>

        <div class="dome-label">Font</div>
        <select id="font-select" class="dome-input">
            <option>Montserrat Medium</option>
            <option>Franklin Gothic Demi Regular</option>
            <option>Gill Sans MT Regular</option>
            <option>Cambria Regular</option>
            <option>Georgia Regular</option>
            <option>Verdana Bold</option>
        </select>

        <div class="dome-label">Text color</div>
        <select id="text-color" class="dome-input">
            <option value="#ffffff">White</option>
            <option value="#000000">Black</option>
            <option value="#ff0000">Red</option>
            <option value="#ffd700">Yellow</option>
            <option value="#00a2ff">Blue</option>
        </select>

        <div class="dome-label">Text size</div>
        <input type="range" id="text-size" min="20" max="120" value="60" class="dome-input">

        <div class="dome-label">Logo zoom</div>
        <input type="range" id="logo-zoom" min="0.2" max="3" step="0.01" value="1" class="dome-input">

        <button id="save-preview" class="dome-btn">Save preview (PNG)</button>
        <button id="reset-preview" class="dome-btn red">Reset</button>

        <p class="dome-help">
            This preview helps you position your logo and text.<br>
            After saving, upload the PNG below in the “Upload your design” field of the product.
        </p>
    </div>
</div>

<script>
  const canvas = document.getElementById("dome-canvas");
  const ctx = canvas.getContext("2d");

  // ---------------- STATE ----------------
  let bgKey = "white"; // white, black, red, blue, silver
  let textValue = "";
  let textSize = 60;
  let textColor = "#ffffff";
  let fontName = "Montserrat Medium";
  let logoImg = null;
  let logoZoom = 1;
  let dragX = 0, dragY = 0;
  let dragging = false;
  let startX = 0, startY = 0;

  const CX = 400;
  const CY = 400;
  const R  = 380;

  // --------------- DOME / RESIN BACKGROUND ---------------
  function drawDomeBackground() {
    ctx.save();

    // BASE GRADIENT (цвят + купол)
    let light, mid, edge;

    switch (bgKey) {
      case "black":
        light = "#555555";
        mid   = "#141414";
        edge  = "#000000";
        break;
      case "red":
        light = "#ffb3b3";
        mid   = "#e00000";
        edge  = "#5a0000";
        break;
      case "blue":
        light = "#9fc7ff";
        mid   = "#0055ff";
        edge  = "#00133d";
        break;
      case "silver":
        light = "#f8f8f8";
        mid   = "#c0c0c0";
        edge  = "#7d7d7d";
        break;
      case "white":
      default:
        light = "#ffffff";
        mid   = "#f7f7f7";
        edge  = "#e0e0e0";
        break;
    }

    const baseGrad = ctx.createRadialGradient(
      CX - R * 0.3, CY - R * 0.3, R * 0.1,
      CX, CY, R
    );
    baseGrad.addColorStop(0.0, light);
    baseGrad.addColorStop(0.6, mid);
    baseGrad.addColorStop(1.0, edge);

    ctx.fillStyle = baseGrad;
    ctx.beginPath();
    ctx.arc(CX, CY, R, 0, Math.PI * 2);
    ctx.fill();

    // GLOSS / RESIN OVERLAY (силен гланц)
    const glossGrad = ctx.createLinearGradient(
      CX - R, CY - R,
      CX + R, CY + R
    );
    glossGrad.addColorStop(0.0, "rgba(255,255,255,0.9)");
    glossGrad.addColorStop(0.35, "rgba(255,255,255,0.25)");
    glossGrad.addColorStop(0.55, "rgba(255,255,255,0.00)");
    glossGrad.addColorStop(1.0, "rgba(0,0,0,0.40)");

    ctx.fillStyle = glossGrad;
    ctx.beginPath();
    ctx.arc(CX, CY, R, 0, Math.PI * 2);
    ctx.fill();

    // HOTSPOT – елипсовидно отражение, типична смола
    ctx.beginPath();
    ctx.ellipse(
      CX - R * 0.3,
      CY - R * 0.35,
      R * 0.45,
      R * 0.25,
      -0.6,
      0,
      Math.PI * 2
    );
    ctx.fillStyle = "rgba(255,255,255,0.92)";
    ctx.fill();

    ctx.restore();
  }

  // --------------- MAIN DRAW ----------------
  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // background + resin
    drawDomeBackground();

    // LOGO
    if (logoImg) {
      let w = logoImg.width * logoZoom;
      let h = logoImg.height * logoZoom;
      ctx.drawImage(logoImg, CX - w / 2 + dragX, CY - h / 2 + dragY, w, h);
    }

    // TEXT
    if (textValue.trim() !== "") {
      ctx.font = `${textSize}px "${fontName}"`;
      ctx.fillStyle = textColor;
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillText(textValue, CX, CY + R * 0.05);
    }
  }

  // --------------- INTERACTION: DRAG LOGO ----------------
  canvas.addEventListener("mousedown", e => {
    dragging = true;
    startX = e.offsetX - dragX;
    startY = e.offsetY - dragY;
  });
  canvas.addEventListener("mousemove", e => {
    if (dragging) {
      dragX = e.offsetX - startX;
      dragY = e.offsetY - startY;
      draw();
    }
  });
  canvas.addEventListener("mouseup", () => dragging = false);
  canvas.addEventListener("mouseleave", () => dragging = false);

  // --------------- UI BINDINGS ----------------
  // Background buttons
  document.querySelectorAll("#bg-colors button").forEach(btn => {
    btn.addEventListener("click", () => {
      bgKey = btn.dataset.bg;
      draw();
    });
  });

  // Text
  document.getElementById("preview-text").addEventListener("input", e => {
    textValue = e.target.value;
    draw();
  });

  document.getElementById("text-size").addEventListener("input", e => {
    textSize = Number(e.target.value);
    draw();
  });

  document.getElementById("text-color").addEventListener("change", e => {
    textColor = e.target.value;
    draw();
  });

  document.getElementById("font-select").addEventListener("change", e => {
    fontName = e.target.value;
    draw();
  });

  // Logo upload
  document.getElementById("logo-upload").addEventListener("change", e => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function (ev) {
      logoImg = new Image();
      logoImg.onload = draw;
      logoImg.src = ev.target.result;
    };
    reader.readAsDataURL(file);
  });

  // Logo zoom
  document.getElementById("logo-zoom").addEventListener("input", e => {
    logoZoom = Number(e.target.value);
    draw();
  });

  // Save PNG
  document.getElementById("save-preview").addEventListener("click", () => {
    const a = document.createElement("a");
    a.href = canvas.toDataURL("image/png");
    a.download = "custom-dome-preview.png";
    a.click();
  });

  // Reset
  document.getElementById("reset-preview").addEventListener("click", () => {
    logoImg  = null;
    dragX    = 0;
    dragY    = 0;
    textValue = "";
    document.getElementById("preview-text").value = "";
    draw();
  });

  // Initial render
  draw();
</script>

</body>
</html>
